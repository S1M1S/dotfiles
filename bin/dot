#!/bin/bash
DF="$HOME/dotfiles"

CONF_DIR="$HOME/.config"
DF_CONF_DIR="$DF/.config"

function clink {
  echo "linking up: $1"

  SRC="$DF/$1"
  DEST="$HOME/$1"

  rm -rf "$DEST" &> /dev/null
  ln -s "$SRC" "$DEST"
}

function configlink {
  echo "linking up: $1"

  SRC="$DF_CONF_DIR/$1"
  DEST="$CONF_DIR/$1"

  rm -r "$DEST" &> /dev/null

  ln -s "$SRC" "$DEST"
}

if [[ "$1" == "link" ]]; then
  # dot link

  links=(".zshrc" ".tmux.conf")
  for l in ${links[@]}; do
    clink "$l"
  done

  configlink "fontconfig"
  configlink "goneovim"
  configlink "kitty"
  configlink "nvim"
  configlink "sway"
  configlink "waybar"

elif [[ "$1" == "update" || "$1" == "up" ]]; then
  # dot update

  git -C "$DF" pull
  . ali refresh

else
  # dot

  echo "USAGE: "
  echo "dot link    -> make symlinks in home directory"
  echo "dot update  -> run git pull on the dotfile directory"
fi

